# 배포 Deployment 란?
>[!info] 배포<br>
>개발자 : <u>"이제 기능 구현도 끝났고 테스트도 마쳤으니 **배포**하자!" </u> 라는 말을 많이 한다. <br>
>- **배포** 란? <span style="background:#fff88f">다른 사용자들이 인터넷을 통해서 사용할 수 있게 만드는 걸 의미</span>한다.<br>
>  = 우리가 만든 웹 페이지나 서버를 다른 사람들이 사용하려면 인터넷 상에 먼저 배포되어 있어야 한다.

![](https://i.imgur.com/Ytnb9IF.png)

처음 개발할 때는 localhost라는 주소로 테스트도 하고 개발을 하지만 이 localhost는 다른 컴퓨터에서 접근이 불가한 주소이다. 배포를 하게 되면  IP(ex 124.16.2.1), 도메인(ex www.naver.com) 과 같이 고유의 주소를 부여받게 되고, 다른 컴퓨터에서 그 주소로 접속할 수 있게 된다.

**어떤 서비스를 완성했다면 그 다음 단계로 해야 하는 게 배포(Deployment)이다.**

#  EC2란? /  EC2를 왜 배울까? / 현업에서는  EC2를 주로 언제 쓸까?
##  EC2란?
>[!info] EC2 Elastic Compute Cloud <br>
>컴퓨터를 빌려서 원격으로 접속해 사용하는 서비스.


 EC2를 쉽게 얘기하면 <u>하나의 컴퓨터</u>를 의미한다.

## EC2를 왜 배울까?
서버를 배포하기 위해서는 컴퓨터가 필요하다. 내가 가진 컴퓨터에서 서버를 배포해 다른 사용자들이 인터넷을 통해 접근할 수 있게 만들수도 있지만 *내 컴퓨터로 서버를 배포하게 되면 24시간 동안 컴퓨터를 켜놔야* 한다. 그리고* 인터넷을 통해 내 컴퓨터에 접근할 수 있게 만들다보니 보안적으로 위험*할 수 있다.

이런 불편함이 있어 **자신의 컴퓨터를 사용하지 않고  AWS EC2 라는 컴퓨터를 빌려 사용**하는 것이다.  AWS EC2는 여러 부가기능(로깅, 오토스케일링, 로드밸런싱 등)을 가지고 있다.

##  현업에서는 EC2를 주로 언제 쓸까?
현업에서도 실제 서버를 배포할 때  AWS EC2를 아주 많이 사용한다. **백엔드 서버를 배포**해야 할 때면  EC2에서 서버를 배포해서 사용한다.

> "그러면 프론트엔드 웹 페이지를 배포할 때는  AWS EC2를 사용하지 않는 걸까요?" <br>
> **프론트엔드 웹 페이지를 배포**할 때 AWS EC2를 사용할 수도 있지만 AWS EC2보다  **vercel, netlify 또는 AWS S3를 사용**하여 주로 배포한다.

# 실습1. 리전 Region 선택하기
![](https://i.imgur.com/Vq2oMLB.png)
## 리전 Region 란?
>[!info] 리전 Region <br>
> **인프라를 <u>지리적으로 나누어</u> 배포한 각각의 데이터 센터**를 의미.

![](https://i.imgur.com/FKKKDM1.png)

 - **EC2** = 컴퓨터를 빌려서 원격으로 접속해 사용하는 서비스.
	 - EC2를 통해 빌려서 쓸 수 있는 컴퓨터들이 전 세계적으로 다양하게 분포해 있다. 이렇게 컴퓨터들이 위치한 위치를 보고  AWS를 에서는  <u>Region</u> 이라 한다.

### 리전 Region 의 특징
1. AWS는 전 세계적으로 다양한 Region 을 보유하고 있다.
2. 각 Region은 고유의 이름을 가지고 있다.
	![](https://i.imgur.com/BlzX2ye.png)

### 리전 Region 의 선택 기준
사람들이 애플리케이션을 사용할 때는 네트워크를 통해 통신하게 된다. 사용자의 위치와 애플리케이션을 실행시키고 있는 *컴퓨터와 위치가 멀면 멀수록 속도가 느려진다*. 따라서 **<u>애플리케이션의 주된 사용자들의 위치와 지리적으로 가까운 리전(Region)을 선택하는 것이 유리</u>**하다.

`ex) 한국 유저들이 주로 사용하는 서비스를 만들거라면 Region을 아시아 태평양(서울)로 선택하면 된다.`

>[!bug] 많이 하는 실수
**아시아 태평양(서울) 리**전에서 EC2를 생성해놓고, 실수로 <u>미국 동부(버지니아 북부) 리전에 들어가서 생성한 EC2가 없어졌다고 당황</u>하는 경우가 있다.
리전(Region)마다 EC2가 따로따로 관리가 되고 있으니 유의하자.

# 실습 2. EC2 셋팅하기 - 기본 설정
![](https://i.imgur.com/EbQoUJg.png)
## 이름 및 태그
![](https://i.imgur.com/uSLmHqY.png)

우리는 나중에 여러 컴퓨터를 빌리게 될텐데 (ex. 용도별, 서버별, 배포용 서버, 개발용 서버 등등 ...) 우리가 식별할 이름을 적어주면 된다. 일반적으로 배포하고자 하는 프로그램-server 식으로 이름을 적게 된다.

##  Application and OS Images (Amazon Machine Image)
![](https://i.imgur.com/SLSbHA4.png)
- OS를 선택하는 단계.
- **Ubuntu 를 선택**
	- 이유
		- 맥과 윈도우라는 운영체제는 컴퓨터를 잘 모르는 사람도 쉽게 사용할 수 있도록 편의 기능을 많이 가지고 있다.
		- 그러다보니 용량을 많이 차지하여 서버를 배포할 때 서버의 성능이 떨어질 수 있다.
		- **최소한의 기능만 있는 OS를 선택하는 것이 유리**하다.
- 버전은 **최신버전**을 사용하면 된다.
	![](https://i.imgur.com/qNTftun.png)

## 인스턴스 유형
#AWS용어정리
>[!info] **인스턴스**란? <br>
>AWS **EC2에서 빌리는 컴퓨터 1대**를 의미 = 단위.

>[!info] **인스턴스 유형**이란? <br>
> EC2에서 빌리는 컴퓨터의 사양

![](https://i.imgur.com/KJpvsJs.png)
서비스마다 다를 수 있지만 **t2.micro 인스턴스 유형을 사용**하더라도 서비스를 운영하는데 크게 문제가 없는 경우가 많다. 성능에 문제가 직접적으로 생기기 전까지는 크게 걱정하지 않아도 된다.

## 키 페어(로그인)
![](https://i.imgur.com/F83EPDv.png)
- EC2에 접근할 때 사용하는 비밀번호.

![](https://i.imgur.com/0jQ22dc.png)

- **키 페어의 이름은 직관적으로 알아볼 수 있게 작성하기!**
- 이름 외의 설정은 크게 중요하지 않다 (아직은).
![](https://i.imgur.com/fI8UatQ.png)
작성 후에 키 페어 생성을 누르면 파일이 하나 다운받아 지는데 EC2에 접속할 때마다 필요한 파일이라 잃어버리지 않게 주의해야 한다.

# 실습 3. EC2 셋팅하기 - 보안그룹 설정
![](https://i.imgur.com/xqvql7m.png)
**편집 버튼** 누르기.
1) VPC 개념
	> [!important] AWS 입문자에게는 VPC 개념은 나중에 익숙해졌을 때 공부해도 좋다.
	
	
	![](https://i.imgur.com/TZZkYeX.png)
2) 보안 그룹
	- 하지만 **Security Groups** 보안그룹은 서버를 배포할 때 중요한 개념이므로 자세히 알아야 한다.
	![](https://i.imgur.com/tI80pjE.png)

## 보안 그룹 Security Group 이란?
>[!important] 보안 그룹 Security Group <br>
> <u>AWS 클라우드에서의 네트워크 보안</u>을 의미한다.

![](https://i.imgur.com/wwGJimy.png)

<u>EC2 인스턴스</u>를 **집**, <u>보안 그룹</u>은 **집 바깥 쪽에 쳐져있는 울타리와 대문**이라고 생각하자. 집에 접근할 때 울타리의 대문에서 접근해도 되는 요청인지 보안 요원이 검사하는 것과 비슷하다.

인터넷에서 일부 사용자가 EC2 인스턴스에 접근하려고 한다고 가정했을 때, 위 그림과 같이 EC2 인스턴스 주위에 방화벽 역할을 할 **<u>보안 그룹(Security Group)</u>**을 만들고 보안 그룹에 규칙을 지정한다. 
- **인바운드 트래픽** (**<u>외부에서 EC2 인스턴스로 보내는 트래픽</u>**)에서 어떤 트래픽만 허용할 지 설정
- **아웃바운드 트래픽** (**EC2 인스턴스에서 외부로 나가는 트래픽<u></u>**) 에서 어떤 트래픽만 허용할 지 설정

![](https://i.imgur.com/RhQcfXn.png)

- **보안 그룹 이름 ** : 알아보기 좋게 이름 작성

- **인바운드 보안 그룹 규칙**
	![](https://i.imgur.com/yCTogYY.png)
	- IP , Port 를 바탕으로 설정
	- ssh : 원격 접속하기 위한 경로
	- 지금 위의 설정은 ssh 유형 , TCP 프로토콜 22번 포트로 위치에 상관없이 접속할 수 있다는 내용이다.

- 추가 보안그룹 규칙
	![](https://i.imgur.com/JLGuW07.png)
	- 80번 포트로 들어오는 경우 HTTP 요청에 대해서는 EC2로 들어오도록 설정하겠다. (80번 포트에 백엔드 서버를 띄울 예정이므로)

# 보충. IP 와 Port 의 개념
[[1. 인터넷 네트워크]]

>[!important] IP의 개념
>- 네트워크 상에서의 **<u>특정 컴퓨터를 가리키는 주소</u>**
>ex. `13.250.15.132`

![](https://i.imgur.com/vRZAIxH.png)
>[!note] nslookup
```shell
nslookup naver.com
//nslookup : ip를 알아내는 명령어
```

>[!important] Port의 개념
>한 컴퓨터 내에서 **<u>실행되고 있는 특정 프로그램의 주소</u>**
>ex. 13.250.15.132`:3000`

한 컴퓨터 내에서 여러 프로그램이 실행되고 있을 것이다. 지금도 사파리, 옵시디언, 세션, 크롬 등 다양한 프로그램이 동시에 실행되고 있는데 실제 서버를 운영하는 컴퓨터도 동일하다. 하나의 컴퓨터에서 여러가지 프로그램이 실행되고 있다.

그럼 외부에서 특정 컴퓨터 내부에 있는 Spring Boot 라는 서버에 통신을 하고 싶다 가정 했을 때, 외부에서 IP 주소만 알아서는 실행되고 있는 여러 프로그램 중 어떤 프로그램과 통신을 해야 할 지 알 수 없다. 그래서 특정 서버와 통신을 할 때는 IP 주소와 서버가 실행되고 있는 **포트 번호**까지 알고 있어야 한다.

>[!question] 브라우저 창에 포트 번호를 입력하지 않는 이유?
>주소창에 도메인 주소를 입력해서 엔터를 누르면, 브라우저(크롬, 사파리 등)는**기본적으로 80번 포트로 통신을 보내게 설정**되어 있다. 그래서 포트 번호를 입력해주지 않아도 통신이 잘 된다. 

>[!note] 잘 알려진 포트(well-known port) 란?!
>포트(Port)에는 잘 알려진 포트(well-known port) 라는 개념이 있다. 포트 번호는 0~65,535번까지 사용할 수 있는데 그 중에 0~1023번까지의 포트 번호는 주요 통신을 위한 규약에 따라 이미 정해져 있다. 이렇게 규약을 통해 역할이 정해져 있는 포트 번호를 보고 잘 알려진 포트라고 부른다.

**규약으로 정해져 있는 포트 번호 중 자주 사용되는 포트 번호**
- **22번 (SSH, Secure Shell Protocol)**
	- 원격 접속을 위한 포트 번호
	- EC2 인스턴스에 연결할 때 22번 포트를 사용한다.
- **80번 (HTTP)**
	- HTTP통신을 할 때 사용
- 4**43번 (HTTPS)**
	- HTTPS로 통신할 때 사용 

[학습 페이지](https://www.inflearn.com/course/lecture?courseSlug=비전공자-이해할수있는-aws-입문실전&unitId=195913&tab=curriculum)
실습4부터 이어듣기 #미완료 